# **MariaDB 전체 운영** 

## 핵심 개념

- 데이터베이스 관련 필수 용어 파악
- 데이터베이스 생성
- 테이블 생성
- 데이터 입력
- 데이터 조회와 활용
- 인덱스, 뷰, 스토어드 프로시저, 트리거 등의 활용
- 데이터 백업과 복원
- 응용프로그램과 MariaDB의 연동

##  요구사항 분석과 시스템 설계 그리고 모델링

### 정보시스템 구척 절차 요약

- 분석, 설계, 구현, 시험, 유지보수의 5가지 단계

- 분석

  - 구현하고자 하는 프로젝트의 가장 첫 번째 단계

  - 시스템 분석 또는 요구사항 분석

    - 현재 우리가 무엇을 할 것인지 결정

    - 사용자의 인터뷰와 업무 조사 등을 수행

    - 프로젝트의 첫 단추를 끼우는 중요한 단계

    - 많은 시간 동안 심혈을 기울여야 함

    - 분석의 결과로서 많은 문서 작성

      

- 설계

  - 시스템 설계 또는 프로그램 설계라는 용어로 부름

  - 우리가 구축하고자 하는 시스템을 어떻게 할 것인지 결정

  - 시스템 설계가 끝나면 가장 큰 작업이 끝난 것으로 간주

  - 대부분의 프로젝트에서 이 분석과 설계의 과정이 전체 공정의 50% 이상을 차지

    

- 구현

  - 시스템 설계가 끝나고 나면 그 결과 문서들을 프로그래머에게 넘겨주면 프로그래머는 설계서에 나온 그대로 프로그램 작성



### 데이터베이스 모델링과 필수 용어

- 데이터베이스 모델링
  - 현실세계에서 사용되는 데이터를 MariaDB에 어떻게 옮겨놓을 것인지를 결정하는 과정
  - 저장할 정보는 테이블 Table이라는 형식에 맞춰 저장



- 데이터베이스 모델링 관련 용어

  - 데이터

    - 단편적인 정포

    - 정보는 있으나 아직 체계화되지 못한 상태

      

  - 테이블

    - 회원이나 제품의 데이터를 입력하기 위해, 표 형태로 표현

      

  - 데이터베이스(DB)

    - 테이블이 저장되는 저장소

    - 원통 모양으로 주로 표현

    - 각 데이터베이스는 서로 다른 고유한 이름을 가지고 있어야 함

      

  - DBMS

    - DataBase management System

    - 데이터베이스를 관리하는 시스템 또는 소프트웨어

      

  - 열 (column, field, 가로)

    - 테이블의 구성 요소

    - 회원 테이블의 경우에는 아이디, 회원 이름, 주소 등 3개의 열로 구성

      

  - 열 이름

    - 각 열을 구분하기 위한 이름

    - 열 이름은 각 테이블 내에서 중복되지 않고, 고유해야 함

      

  - 데이터 형식

    - 열의 데이터 형식

      - 테이블을 생성할 때 열 이름과 함께 지정

        

  - 행 (row, 세로)

    - 실질적인 데이터

      

  - 기본 키

    - Primart Key (주 키)

    - 각 행을 구분하는 유일한 열

    - 중복X, 비는 것 X

    - 각 테이블에는 기본 키가 하나만 지정

      

  - 외래 키

    - Foreign Key 필드

    - 두 테이블의 관계를 맺어주는 키

      

  - SQL

    - 사람과  DBMS가 소통하기 위한 말(언어)

    

## MariaDB를 이용한 데이터베이스 구축 절차

### 데이터베이스 구축 / 관리 및 활용의 전반적인 절차

1. 데이터베이스 생성

   - 테이블 외의 데이터베이스 개체의 활용
   - 데이터 백업 및 솬리

2. 테이블 생성

3. 데이터 입력

   - 응용프로그램에서 구축된 데이터 활용 (웹서비스/애플리케이션)

4. 데이터 조회/활용

   

### 데이터 활용

- select 문 사용법

  - **SELECT** 열 이름 **FROM** 테이블 이름 **WHERE** 조건

    

- SQL문으로 테이블 생성

  - 공백을 처리해주는 backtick 실습
    - **CREATE** **TABLE** my testTBL (id INT):
    - -- 하이픈 두 개로 주석 처리

## 

## 테이블 외의 데이터베이스 개체의 활용

### 인덱스

인덱스 (INDEX)

- 책의 뒤에 붙어 있는 '찾아보기' (색인)와 같은 개념
- 실무에서 사용되는 대용량 데이터의 경우 필요
- 데이터베이스 기능을 향상시키는 튜닝에서 중요한 요소
  - 쿼리 문에 대한 응답 속도 향상
- 데이터의 열 단위에 생성



인덱스 사용

- 인덱스 생성 후 실행계획 확인
  - **CREATE INDEX** idx_indexTBL_firstname **ON** indexTBLE(first_name);



### 뷰

뷰 (view)

- 가상의 테이블
  - 실제 행 데이터를 가지고 있지 않음
- 사용자의 입장에서는 테이블과 동일하게 보임
- 실체는 없는 것이며, 진짜 테이블에 링크Link된 개념
- 뷰를 SELECT하면 진짜 테이블의 데이터를 조회하는 것과 동일
- 개인정보 보호와 같은 데이터 보호/보안을 위해서도 사용



뷰의 사용법

- 뷰를 만들고 내용 조회

``` mysql
CREATE VIEW uv_memberTBLE
AS
	SELECT memberName, memberAddress FROM memberTBL ;
```



### 스토어드 프로시저

스토어드 프로시저

- MariaDB에서 제공해주는 프로그래밍 기능
- SQL 문을 하나로 묶어서 편라하게 사용하는 기능
- 다른 프로그래밍 언어와 같은 기능을 담당하기도 함
- 실무에서는 SQL 문을 하나씩 실행하는 것 보다 스토어드 프로시저로 관리하는 경우가 많음



### 트리거

트리거

- 테이블에 부착되어서, 테이블에 INSERT나 UPDATE 또는 DELETE작업이 발생되면 실행되는 코드
- 예) 회원이 탈퇴할 경우 탈퇴자 테이블에 데이터를 일부 옮겨놓고 지우는 작업

트리거 용도

- 회원 가입 / 업데이트 / 삭제의 일련 작업
- 회원 가입했던 적이 있는지 기록이 없어 증명을 요구할 경우에는 어떻게 하는가?
  - 삭제 작업이 일어날 경우 백업 테이블에 지워진 데이터 기록하는 트리거 생성

``` mysql
DELIMITER //
CREATE TRIGGER trg_deletedMemberTBL -- 트리거 이름
	AFTER DELETE -- 삭제 후에 작동하게 지정
	ON memberTBL -- 트리거를 부착할 테이블
	FOR EACH ROW -- 각 행마다 적용
BEGIN
	-- OLD 테이블의 내용을 백업 테이블에 삽입
	INSERT INTO deletedMemberTBL
		VALUES(OLD.memberID, OLD/memberName, OLD.memberAddress, CURDATE() );
		
END //
DELIMITER ;
```



